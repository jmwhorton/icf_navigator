{% extends "base_header.html" %}
{% block header_title %}{% endblock %}
{% block content %}
<div class="container">
  <h2 class="display-7 fw-bold">{{cf.study_name}}</h2>
  <div class="row g-4 py-5 row-cols-1 row-cols-lg-2">
    <div class="col d-flex align-items-start">
        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
          <i class="bi fas fa-question-circle fa-2x" style="width:1em;height: 1em"></i>
        </div>
        <div>
          <h2>Answer Questions</h2>
          <p>Here you will answer questions about your study to help us build the consent form for you.</p>
          <a href="{% url 'form' form_id=cf.pk section_id=first_section %}">
            <button type="button" class="btn btn-primary">Continue Survey</button>
          </a>
        </div>
      </div>
    <div class="col d-flex align-items-start">
        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
          <i class="bi fas fa-print fa-2x" style="width:1em;height: 1em"></i>
        </div>
        <div>
          <h2>PDF Form</h2>
          <p>View the application output in your browser. From here you can save the document as a PDF or print.</p>
          <a href="{% url 'form_print' cf.pk %}">
            <button type="button" class="btn btn-primary">View Form</button>
          </a>
        </div>
      </div>
    </div>
  <div class="row w-50">
    <h4>Authorized Users</h4>
    <div class="list-group">
    {% for email in cf.authorized_users.all %}
      <div class="list-group-item d-flex justify-content-between align-items-start">
        <span>{{email.email}}</span>
        {% if email.email != user.email %}
        <form action="delete" method="post">
          {% csrf_token %}
          <input type="hidden" name="email" value="{{email.email}}"/>
          <button class="badge rounded-pill bg-danger" type="submit" name="save"><i class="fas fa-user-slash"></i></button>
        </form>
        {% endif %}
       </div>
    {% endfor %}
    </div>
  </div>
  <div class="row mt-4">
    <h4>Add Additional Authorized Users</h4>
    {% if form.errors %}
    <p>{{form.errors}}</p>
    {% endif %}
    <form method="post">
      {% csrf_token %}
      <div class="form-group">
        <label for="id_email">Email</label>
        <div class="row row-cols-lg-auto">
          <div class="col-12">
            <input class="form-control" type="email" name="email" required="" id="id_email">
          </div>
          <div class="col-12">
            <button class="btn btn-success" type="submit" name="save"><i class="fas fa-user-plus"></i></button>
          </div>
        </div>
      </div>
    </form>
    </div>
  </div>
</div>
{% endblock %}
